<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>혼공머 08-2 | DJ’s portfolio</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="혼공머 08-2" />
<meta name="author" content="김동준" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="합성곱 신경망을 사용한 이미지 분류" />
<meta property="og:description" content="합성곱 신경망을 사용한 이미지 분류" />
<link rel="canonical" href="https://cjfal.github.io/dj/python/%ED%98%BC%EA%B3%B5%EB%A8%B8/2022/03/21/%ED%98%BC%EA%B3%B5%EB%A8%B88%EC%B1%952%EC%9E%A5.html" />
<meta property="og:url" content="https://cjfal.github.io/dj/python/%ED%98%BC%EA%B3%B5%EB%A8%B8/2022/03/21/%ED%98%BC%EA%B3%B5%EB%A8%B88%EC%B1%952%EC%9E%A5.html" />
<meta property="og:site_name" content="DJ’s portfolio" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-21T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2022-03-21T00:00:00-05:00","url":"https://cjfal.github.io/dj/python/%ED%98%BC%EA%B3%B5%EB%A8%B8/2022/03/21/%ED%98%BC%EA%B3%B5%EB%A8%B88%EC%B1%952%EC%9E%A5.html","@type":"BlogPosting","headline":"혼공머 08-2","dateModified":"2022-03-21T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://cjfal.github.io/dj/python/%ED%98%BC%EA%B3%B5%EB%A8%B8/2022/03/21/%ED%98%BC%EA%B3%B5%EB%A8%B88%EC%B1%952%EC%9E%A5.html"},"author":{"@type":"Person","name":"김동준"},"description":"합성곱 신경망을 사용한 이미지 분류","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/dj/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://cjfal.github.io/dj/feed.xml" title="DJ's portfolio" /><link rel="shortcut icon" type="image/x-icon" href="/dj/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/dj/">DJ&#39;s portfolio</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/dj/about/">About Me</a><a class="page-link" href="/dj/search/">Search</a><a class="page-link" href="/dj/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">혼공머 08-2</h1><p class="page-description">합성곱 신경망을 사용한 이미지 분류</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-03-21T00:00:00-05:00" itemprop="datePublished">
        Mar 21, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">김동준</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/dj/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/dj/categories/#혼공머">혼공머</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/cjfal/dj/tree/master/_notebooks/2022-03-21-혼공머8챕2장.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/dj/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/cjfal/dj/master?filepath=_notebooks%2F2022-03-21-%ED%98%BC%EA%B3%B5%EB%A8%B88%EC%B1%952%EC%9E%A5.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/dj/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/cjfal/dj/blob/master/_notebooks/2022-03-21-혼공머8챕2장.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/dj/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#주로쓰는-패키지들">주로쓰는 패키지들 </a></li>
<li class="toc-entry toc-h1"><a href="#패션-MNIST-데이터-불러오기">패션 MNIST 데이터 불러오기 </a></li>
<li class="toc-entry toc-h1"><a href="#합성곱-신경망-만들기">합성곱 신경망 만들기 </a>
<ul>
<li class="toc-entry toc-h3"><a href="#모델-파라미터의-개수-계산">모델 파라미터의 개수 계산 </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#모델-컴파일과-훈련">모델 컴파일과 훈련 </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-03-21-혼공머8챕2장.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="주로쓰는-패키지들">
<a class="anchor" href="#%EC%A3%BC%EB%A1%9C%EC%93%B0%EB%8A%94-%ED%8C%A8%ED%82%A4%EC%A7%80%EB%93%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>주로쓰는 패키지들<a class="anchor-link" href="#%EC%A3%BC%EB%A1%9C%EC%93%B0%EB%8A%94-%ED%8C%A8%ED%82%A4%EC%A7%80%EB%93%A4"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1">#넘파이</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1">#판다스</span>
<span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1">#플롯나인</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1">#맷플랏립</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span> <span class="c1">#플랏리 상호작용 그래프</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span> <span class="c1">#블로그에 html로 올리려고 변환하는 패키지</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> <span class="c1"># 씨본, 히스토그램 깔끔하게 그리는 패키지</span>
<span class="c1">#___________________________________</span>

<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span> <span class="c1"># k 최근접이웃</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>  <span class="c1"># 결정계수 </span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span> <span class="c1"># 타깃과 예측의 절댓값 오차 평균을 반환</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span> <span class="c1"># 선형 회귀</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span> <span class="c1">#다중회귀로의 변환기</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span> <span class="c1">#규제</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span> <span class="c1">#릿지</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span> <span class="c1">#라쏘</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span> <span class="c1"># 로지스틱회귀</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">expit</span> <span class="c1">#시그모이드함수</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">softmax</span> <span class="c1">#소프트맥스함수</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDClassifier</span> <span class="c1"># 확률적 경사 하강법</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span> <span class="c1"># 트리</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">plot_tree</span> <span class="c1"># 트리 모형</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span> <span class="c1"># 교차 검증</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span> <span class="c1"># Kfold 교차 검증</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span> <span class="c1"># 그리드 서치 (하이퍼 파라미터 튜닝)</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">randint</span> <span class="c1">#랜덤 서치</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RandomizedSearchCV</span> <span class="c1"># 랜덤 서치 클래스</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span> <span class="c1"># 랜덤포레스트 앙상블</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">ExtraTreesClassifier</span> <span class="c1"># 엑스트라 트리 앙상블</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span> <span class="c1"># 그레이디언트 부스팅 앙상블</span>

<span class="c1"># 히스토그램 기반 그레이디언트 부스팅</span>
<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_hist_gradient_boosting</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">HistGradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.inspection</span> <span class="kn">import</span> <span class="n">permutation_importance</span> <span class="c1"># 특성중요도</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span> <span class="c1"># 알고리즘을 구현한 또다른 라이브러리1</span>
<span class="kn">from</span> <span class="nn">lightgbm</span> <span class="kn">import</span> <span class="n">LGBMClassifier</span> <span class="c1"># 알고리즘을 구현한 또다른 라이브러리2 , 마이크로소프트에서 구현 </span>


<span class="c1"># ____________________</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span> <span class="c1"># KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span> <span class="c1"># 주성분 분석</span>

<span class="c1"># 7장 딥러닝</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span> <span class="c1"># 케라스 </span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span> <span class="c1"># 텐서플로</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="패션-MNIST-데이터-불러오기">
<a class="anchor" href="#%ED%8C%A8%EC%85%98-MNIST-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>패션 MNIST 데이터 불러오기<a class="anchor-link" href="#%ED%8C%A8%EC%85%98-MNIST-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0"> </a>
</h1>
<blockquote>
<p>합성곱 신경망은 2차원 이미지를 그대로 사용하기 위해 펼치는 과정이 없음</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">),</span> <span class="p">(</span><span class="n">test_input</span><span class="p">,</span> <span class="n">test_target</span><span class="p">)</span> <span class="o">=</span> \
    <span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fashion_mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">train_input</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>

<span class="n">train_scaled</span><span class="p">,</span> <span class="n">val_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">val_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="합성곱-신경망-만들기">
<a class="anchor" href="#%ED%95%A9%EC%84%B1%EA%B3%B1-%EC%8B%A0%EA%B2%BD%EB%A7%9D-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>합성곱 신경망 만들기<a class="anchor-link" href="#%ED%95%A9%EC%84%B1%EA%B3%B1-%EC%8B%A0%EA%B2%BD%EB%A7%9D-%EB%A7%8C%EB%93%A4%EA%B8%B0"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>

<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">,</span> 
                              <span class="n">padding</span><span class="o">=</span><span class="s1">'same'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>이 합성곱층은 32개의 필터를 사용</p>
<p>커널의 크기는 (3,3) 이고 렐루 활성화 함수와 세임 패딩을 사용</p>
<p>완전 연결 신경망에서처럼 케라스 신경망 모델의 첫 번째 층에서 입력의 차원을 지정해야함</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>패션 MNIST 이미지가 (28,28) 크기에 세임 패딩을 적용했기 때문에 합성곱 층에서 출력된 특성 맵의 가로세로 크기는 입력과 동일</p>
<p>특성맵의 크기는 절반으로 줄어듦</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">,</span> 
                              <span class="n">padding</span><span class="o">=</span><span class="s1">'same'</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>이 합성곱층은 세임 패딩을 사용. (입력의 가로 세로 크기를 줄이기 않음)</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 특성 맵을 일렬로 펼쳐서 바로 출력층에 전달하지 않고 중간에 하나의 밀집 은닉층을 하나 더 둠</span>
<span class="c1"># 즉 Flatten 클래스 다음에 Dense 은닉층, 마지막으로 Dense 출력층의 순서대로 구성</span>

<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>은닉층과 출력층 사이에 드롭아웃을 넣음.</p>
<p>드롭아웃 층이 은닉층의 과대적합을 막아 성능을 조금 더 개선</p>
<p>은닉층은 100개의 뉴런을 사용하고 활성화 함수는 합성곱 층과 마찬가지로 렐루 함수 사용</p>
<p>패션 MNIST 데이터셋은 클래스 10개를 분류하는 다중 분류 문제이므로 마지막 층의 활성화 함수는 소프트 맥스를 사용</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "sequential_4"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d_8 (Conv2D)           (None, 28, 28, 32)        320       
                                                                 
 max_pooling2d_8 (MaxPooling  (None, 14, 14, 32)       0         
 2D)                                                             
                                                                 
 conv2d_9 (Conv2D)           (None, 14, 14, 64)        18496     
                                                                 
 max_pooling2d_9 (MaxPooling  (None, 7, 7, 64)         0         
 2D)                                                             
                                                                 
 flatten_5 (Flatten)         (None, 3136)              0         
                                                                 
 dense_10 (Dense)            (None, 100)               313700    
                                                                 
 dropout_5 (Dropout)         (None, 100)               0         
                                                                 
 dense_11 (Dense)            (None, 10)                1010      
                                                                 
=================================================================
Total params: 333,526
Trainable params: 333,526
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>합성곱 층과 풀링 층의 효과가 잘 나타나 있음.</p>
<p>첫 번쨰 합성곱 층을 통과하면서 특성 맵의 깊이는 32가 되고 두 번째 합성곱에서 특성 맵의 크기가 64로 늘어남</p>
<p>특성 맵의 가로세로 크기는 첫 번째 풀링 층에서 절반으로 줄어들고 두 번째 풀링층에서 다시 절반으로 더 줄어듦 ( 최종 특성 맵의 크기는 (7,7,64) )</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="모델-파라미터의-개수-계산">
<a class="anchor" href="#%EB%AA%A8%EB%8D%B8-%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0%EC%9D%98-%EA%B0%9C%EC%88%98-%EA%B3%84%EC%82%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>모델 파라미터의 개수 계산<a class="anchor-link" href="#%EB%AA%A8%EB%8D%B8-%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0%EC%9D%98-%EA%B0%9C%EC%88%98-%EA%B3%84%EC%82%B0"> </a>
</h3>
<blockquote>
<p>첫 번째 합성곱 층은 32개의 필터를 가지고 있고 크기가 (3,3), 깊이가 1이고, 필터마다 하나의 절편이 있다.</p>
<blockquote>
<p>총 3x3x1x32+32 = 320 개의 파라미터가 있다.</p>
</blockquote>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>You must install pydot (`pip install pydot`) and install graphviz (see instructions at https://graphviz.gitlab.io/download/) for plot_model/model_to_dot to work.
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">to_file</span><span class="o">=</span><span class="s1">'cnn-architecture.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="모델-컴파일과-훈련">
<a class="anchor" href="#%EB%AA%A8%EB%8D%B8-%EC%BB%B4%ED%8C%8C%EC%9D%BC%EA%B3%BC-%ED%9B%88%EB%A0%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>모델 컴파일과 훈련<a class="anchor-link" href="#%EB%AA%A8%EB%8D%B8-%EC%BB%B4%ED%8C%8C%EC%9D%BC%EA%B3%BC-%ED%9B%88%EB%A0%A8"> </a>
</h1>
<blockquote>
<p>케라스 API의 장점은 딥러닝 모델의 종류나 구성 방식에 상관없이 컴파일과 훈련 과정이 같다는 점이다.</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'sparse_categorical_crossentropy'</span><span class="p">,</span> 
              <span class="n">metrics</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>

<span class="n">checkpoint_cb</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span><span class="s1">'best-cnn-model.h5'</span><span class="p">,</span> 
                                                <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">early_stopping_cb</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">patience</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                  <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                    <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">val_scaled</span><span class="p">,</span> <span class="n">val_target</span><span class="p">),</span>
                    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">checkpoint_cb</span><span class="p">,</span> <span class="n">early_stopping_cb</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/20
1500/1500 [==============================] - 19s 12ms/step - loss: 0.5174 - accuracy: 0.8125 - val_loss: 0.3248 - val_accuracy: 0.8813
Epoch 2/20
1500/1500 [==============================] - 17s 12ms/step - loss: 0.3431 - accuracy: 0.8770 - val_loss: 0.2858 - val_accuracy: 0.8939
Epoch 3/20
1500/1500 [==============================] - 20s 13ms/step - loss: 0.2939 - accuracy: 0.8931 - val_loss: 0.2550 - val_accuracy: 0.9037
Epoch 4/20
1500/1500 [==============================] - 18s 12ms/step - loss: 0.2619 - accuracy: 0.9043 - val_loss: 0.2327 - val_accuracy: 0.9162
Epoch 5/20
1500/1500 [==============================] - 19s 12ms/step - loss: 0.2409 - accuracy: 0.9120 - val_loss: 0.2313 - val_accuracy: 0.9120
Epoch 6/20
1500/1500 [==============================] - 18s 12ms/step - loss: 0.2204 - accuracy: 0.9202 - val_loss: 0.2190 - val_accuracy: 0.9183
Epoch 7/20
1500/1500 [==============================] - 18s 12ms/step - loss: 0.2007 - accuracy: 0.9268 - val_loss: 0.2221 - val_accuracy: 0.9191
Epoch 8/20
1500/1500 [==============================] - 18s 12ms/step - loss: 0.1852 - accuracy: 0.9305 - val_loss: 0.2203 - val_accuracy: 0.9196
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>훈련세트의  정확도가 이전보다 훨씬 좋아졌다.</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">'loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">'val_loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'epoch'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">'train'</span><span class="p">,</span> <span class="s1">'val'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>검증 세트에 대한 손실이 점차 감소하다가 정체되기 시작하고 훈련 세트에 대한 손실은 점점 더 낮아지고 있다.</p>
<p>아홉 번째 에포크를 최적으로 생각할 수 있다.</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">val_scaled</span><span class="p">,</span> <span class="n">val_target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>375/375 [==============================] - 1s 3ms/step - loss: 0.2190 - accuracy: 0.9183
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.2189749926328659, 0.9182500243186951]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>이 결과는 fit 메서ㅏ드의 출력 중 아홉 번째 에포크의 출력과 같다.</p>
<p>EalryStopping 콜백이 model 객체를 최상의 모델 파라미터로 잘 복원</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">val_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'gray_r'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>핸드백 이미지</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[1.1478546e-13 1.5173621e-22 1.5546854e-14 1.3573404e-14 1.0424652e-14
  3.8627394e-13 1.3114199e-15 2.4451533e-15 1.0000000e+00 3.5255428e-19]]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>출력 결과를 보면 아홉 번째 값이 1이고 다른값이 거의 0에 가까움</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'class'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'prob.'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'티셔츠'</span><span class="p">,</span> <span class="s1">'바지'</span><span class="p">,</span> <span class="s1">'스웨터'</span><span class="p">,</span> <span class="s1">'드레스'</span><span class="p">,</span> <span class="s1">'코트'</span><span class="p">,</span>
           <span class="s1">'샌달'</span><span class="p">,</span> <span class="s1">'셔츠'</span><span class="p">,</span> <span class="s1">'스니커즈'</span><span class="p">,</span> <span class="s1">'가방'</span><span class="p">,</span> <span class="s1">'앵클 부츠'</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">preds</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>가방
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_scaled</span> <span class="o">=</span> <span class="n">test_input</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>313/313 [==============================] - 1s 3ms/step - loss: 0.2392 - accuracy: 0.9131
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.23924489319324493, 0.913100004196167]</pre>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="cjfal/dj"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/dj/python/%ED%98%BC%EA%B3%B5%EB%A8%B8/2022/03/21/%ED%98%BC%EA%B3%B5%EB%A8%B88%EC%B1%952%EC%9E%A5.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/dj/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/dj/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/dj/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://www.facebook.com/%EA%B9%80%EB%8F%99%EC%A4%80" target="_blank" title="김동준"><svg class="svg-icon grey"><use xlink:href="/dj/assets/minima-social-icons.svg#facebook"></use></svg></a></li><li><a rel="me" href="https://github.com/cjfal" target="_blank" title="cjfal"><svg class="svg-icon grey"><use xlink:href="/dj/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
